<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Chat</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <!-- Zone de notifications -->
    <div id="notificationArea" class="notification-area"></div>
    
    <!-- Interface de connexion simplifiée -->
    <div class="setup-container" id="setupContainer">
        
        <!-- Page principale de connexion -->
        <div class="main-page" id="mainPage">
            <div class="setup-header">
                <h2>Mini Chat</h2>
                <p>Entrez dans un salon de discussion</p>
            </div>
            
            <div class="setup-form">
                <div class="setup-field">
                    <label for="setupUserId">Votre pseudo :</label>
                    <input type="text" id="setupUserId" placeholder="Votre nom d'utilisateur" maxlength="15">
                </div>
                
                <button id="showJoinRoomBtn" class="join-btn">Rejoindre un salon</button>
                <button id="createRoomBtn" class="create-btn">Creer un salon</button>
                
                <div class="divider">----- ou -----</div>
                
                <button id="showServerListBtn" class="list-btn">Liste des serveurs</button>
            </div>
        </div>
        
        <!-- Page rejoindre un salon -->
        <div class="join-room-page" id="joinRoomPage" style="display: none;">
            <div class="setup-header">
                <h2>Rejoindre un salon</h2>
                <p>Entrez le nom du salon a rejoindre</p>
            </div>
            
            <div class="setup-form">
                <div class="setup-field">
                    <label for="joinRoomId">Nom du salon :</label>
                    <input type="text" id="joinRoomId" placeholder="Nom du salon a rejoindre" maxlength="20">
                </div>
                
                <button id="joinRoomConfirmBtn" class="join-btn">Rejoindre</button>
                <button id="backFromJoinBtn" class="back-btn">Retour</button>
            </div>
        </div>
        
        <!-- Page creation de salon -->
        <div class="create-room-page" id="createRoomPage" style="display: none;">
            <div class="setup-header">
                <h2>Creer un salon</h2>
                <p>Configurez votre nouveau salon</p>
            </div>
            
            <div class="setup-form">
                <div class="setup-field">
                    <label for="createRoomName">Nom du salon :</label>
                    <input type="text" id="createRoomName" placeholder="Nom de votre salon" maxlength="20">
                </div>
                
                <div class="setup-field">
                    <label class="checkbox-label">
                        <input type="checkbox" id="isPrivateRoom"> Salon privé
                    </label>
                </div>
                
                <div class="setup-field" id="passwordField" style="display: none;">
                    <label for="createRoomPassword">Mot de passe :</label>
                    <input type="password" id="createRoomPassword" placeholder="Entrez le mot de passe">
                </div>
                
                <button id="createRoomConfirmBtn" class="create-btn">Creer le salon</button>
                <button id="backFromCreateBtn" class="back-btn">Retour</button>
            </div>
        </div>
        
        <!-- Page demande de mot de passe -->
        <div class="password-page" id="passwordPage" style="display: none;">
            <div class="setup-header">
                <h2>Salon prive</h2>
                <p id="roomNameDisplay">Ce salon necessite un mot de passe</p>
            </div>
            
            <div class="setup-form">
                <div class="setup-field">
                    <label for="roomPassword">Mot de passe :</label>
                    <input type="password" id="roomPassword" placeholder="Entrez le mot de passe">
                </div>
                
                <button id="joinWithPasswordBtn" class="join-btn">Rejoindre le salon</button>
                <button id="backToMainBtn" class="back-btn">Retour</button>
            </div>
        </div>
        
        <!-- Liste des serveurs -->
        <div class="server-list-page" id="serverListPage" style="display: none;">
            <div class="setup-header">
                <h2>Serveurs disponibles</h2>
                <p>Cliquez sur un salon pour le rejoindre</p>
            </div>
            
            <div class="servers-container">
                <div id="serversList" class="servers-list">
                    <div class="loading">Chargement des salons...</div>
                </div>
                
                <button id="backFromServersBtn" class="back-btn">Retour</button>
            </div>
        </div>
        
    </div>

    <!-- Interface de chat principale -->
    <div class="chat-container" id="chatContainer" style="display: none;">
        <div class="chat-header">
            <div class="room-info">
                <h2 id="roomTitle">Salon: ...</h2>
                <small id="roomSubtitle">En attente...</small>
            </div>
            
            <div class="header-actions">
                <div class="online-counter" id="onlineCount">
                    <span class="status-dot" id="statusDot"></span>
                    <span class="count-number">0</span>
                    <span class="count-label">en ligne</span>
                </div>
                <button id="logoutBtn" class="logout-btn">Déconnexion</button>
            </div>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="welcome-message">Salon pret ! Commencez a discuter...</div>
        </div>
        
        <div class="quick-actions">
            <button class="quick-btn" id="shareCurrentTab">Partager cette page</button>
            <button class="quick-btn" id="shareClipboard">Partager le presse-papier</button>
        </div>

        <div class="chat-input-container">
            <div class="input-wrapper">
                <textarea id="messageInput" placeholder="Tapez votre message..."></textarea>
                <button id="sendButton" class="send-btn">Envoyer</button>
            </div>
        </div>
    </div>
    
    <!-- Firebase SDK local -->
    <script src="firebase-app.js"></script>
    <script src="firebase-auth.js"></script>
    <script src="firebase-database.js"></script>
    
    <script src="utils.js"></script>
    <script src="firebase-config.js"></script>
    <script src="firebase-loader.js"></script>
    <script src="firebase-manager.js"></script>
    <script src="popup.js"></script>
</body>
</html>